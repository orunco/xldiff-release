# xlDiff

**一个更加好用、易于理解、更有效率、资源优先的电子表格比对应用**✨

关键字：**xls比较 xlsx比较 比对 diff compare excel sheet Spreadsheet**

![Preview](https://github.com/orunco/xldiff-release/blob/master/preview.gif) 



您有两个Excel工作簿，或者同一工作簿的两个版本，您想查看它们之间的更改，或者，您希望查找潜在的问题。简单的比较总是很容易，例如：

- 一般的单元格值变化
- Sheet名称变化
- 等等

已经有大量现成工具可以支持，或者您自己可以通过编写代码的方式进行比较。但是在一些特殊场景下，情况会变得有点棘手：

- **整列移动、复制、粘贴**：整列数据从一个位置到另外一个位置，实际内容可能并没有发生变化。
- **比对结果的可理解性**：两个工作簿的比较结果可能复杂到难以理解的程度，在这种情况下，如何提升比较报告界面的可理解性，是解决比较问题的最后关键一步。
- **公式值的准确性**：比较的基础在于准确解析出单元格中的值，包括公式值和格式化值。如果直接采用Microsoft Office原生Excel得到结果，结果是准确的，但是对于超大表格，性能问题比较难以解决；如果采用第三方组件直接解析，结果很难和Microsoft Excel结果相同。
- **超大Excel**：小型数据集的比较总是容易的，然而xlsx格式支持1048576行*16384列，对于中大型数据集，需要平衡其读取xlsx性能、比较算法和内存资源要求。

xlDiff试图解决上述问题，以构建一个更加好用、易于理解、更有效率的电子表格比对应用。



## 使用步骤

```markdown
下载`Orunco.xlDiff-win-x64.zip`版本到本地
解压缩并运行`xldiff_desktop-Native-win-x64.exe`
选择文件，并配置需要比对哪些Sheet、每个Sheet的表头、以及需要比对哪些字段
点击比对
查看结果
```






## 核心概念

不同于现存的大部分工具，xlDiff在比较前是需要进行Sheet配对和列头配对操作，当然xlDiff会根据一定的规则自动初始化这种配置，也可以根据实际需要手工配置，初始样例数据可以加载安装文件夹下Sample数据。



## 功能简介

比较操作关键步骤：

1. 选择需要比较的2个文件
2. 对sheet进行配对操作：例如Sheet1和Sheet2进行比较
3. 对sheet设置其列头信息：例如指定Sheet1的列头是第2行，从而让xlDiff读取其列名
4. 对sheet中的列进行配对操作：例如A列和B列进行比较
5. 执行比较算法，分析比较结果



## 数据隐私与安全

我们尊重您的隐私，并非常小心地保护您的信息。我们不会上传任何本地用户数据或涉及个人信息的数据。对原始xls/xlsx为只读操作，不存在任何对原始文件的写入和修改操作，不存在破坏您本地数据的情况。



## LICENSE

除第三方组件外，其余版权归Orunco所有。保留所有权利。



## 声明

本文档内容经过精心创建和安排。我们对所提供内容的准确性、完整性和及时性不承担任何责任。对于数据的最终比较结果，尽力保证，但不完全保证其准确性。



## 杀毒软件

未采购第三方数字证书，因此杀毒软件有可能误报。

版本发布前会进行在线病毒扫描，确认不包含/不存在病毒。



## 变更记录
### 25.07.0.0

- 支持简体中文版，包括xlDiff界面/Spreadsheet数据内容/数值格式
- 支持读取xls和xlsx文件
- 支持sheet的配对操作
  - 支持一次性清除全部sheet
  - 支持选择单个sheet进行比较
- 支持sheet设置其列头信息：当前界面右边仅仅是数据预览和设置列头信息，最多显示前1000行，不代表数据未读取
- 支持sheet中的列进行配对操作
  - 支持重新自动配对
  - 支持删除部分字段的配对
  - 支持按照序号而不是名称进行配对
- 右键菜单支持忽略列的设置
- 尽最大能力支持简体中文环境下单元格格式化值的准确性
- 对于公式值不做计算，以读取时的文件中保存值为准，最大程度保证公式计算值准确性
- 支持快速比较算法：当行和行之间的差异小于某一个阈值值，作为修改行，否则标记为删除行/增加行
- 支持导出分析比较结果（本机需要有可以操作xls/xlsx的应用），用户可自行根据结果值最大程度还原原始数据以及差异数据
- 仅支持单元格值的比较
- 尽最大努力实现了性能和内存的优化
- 仅支持windows 10 64位环境/windows 11 64位环境

  
